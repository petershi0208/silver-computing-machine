<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><script src="Forgot%20_files/hm.js"></script><script src="Forgot%20_files/hm.js"></script><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7a4194d0e685be66c947452dc8646475";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
<meta name="renderer" content="webkit">
<title>大钱财富忘记密码</title>
<link rel="shortcut icon" href="/Daqian/image/5987.ico">
<meta name="keywords" content="">
<meta name="description" content="">
 <link  href="<%=request.getContextPath()%>/index_files/logotitle.ico" rel="shortcut icon">
 <link href="<%=request.getContextPath()%>/Forgot%20_files/ligerui-all.css" rel="stylesheet" type="text/css">
    <link href="<%=request.getContextPath()%>/Forgot%20_files/all.css" rel="stylesheet" type="text/css">
    <script src="<%=request.getContextPath()%>/Forgot%20_files/jquery-1.js" type="text/javascript"></script>
    <script src="<%=request.getContextPath()%>/Forgot%20_files/base.js" type="text/javascript"></script>
    <script src="<%=request.getContextPath()%>/Forgot%20_files/ligerDrag.js" type="text/javascript"></script> 
    <script src="<%=request.getContextPath()%>/Forgot%20_files/ligerDialog.js" type="text/javascript"></script>


<!-- <script src="../styles/web/js/jquery1.42.min.js" type="text/javascript"></script> -->
<script src="<%=request.getContextPath()%>/Forgot%20_files/jquery.js" type="text/javascript"></script>
<script src="<%=request.getContextPath()%>/Forgot%20_files/jquery_002.js" type="text/javascript"></script>
<script src="<%=request.getContextPath()%>/Forgot%20_files/member_center.js" type="text/javascript"></script>

<script src="<%=request.getContextPath()%>/Forgot%20_files/WdatePicker.js" type="text/javascript">
</script>
<link type="text/css" rel="stylesheet" href="<%=request.getContextPath()%>/Forgot%20_files/WdatePicker.css">

<link href="<%=request.getContextPath()%>/Forgot%20_files/borrower_user.css" rel="stylesheet" type="text/css">
<link href="<%=request.getContextPath()%>/Forgot%20_files/borrower.css" rel="stylesheet" type="text/css">
<link href="<%=request.getContextPath()%>/Forgot%20_files/head.css" rel="stylesheet" type="text/css">
<link href="<%=request.getContextPath()%>/Forgot%20_files/lrtk.htm" rel="stylesheet" type="text/css">
<style type="text/css">
#li-ul li a{ font-size:15px;height:22px;line-height: 22px}
</style>
<script type="text/javascript">	
	function replaceUrl(id,term,sm,productName,enables,logins){
	    var hrefs = ""; 
		if(enables==0){
			hrefs = "/webApplicationFinancialInvest/financialLogout?onLineProductTerm="+term+"&sm_sm="+sm;
		}else{
			if(logins=="1"){
				hrefs = "/webApplicationFinancialInvest/financialBuyLogin?onLineProductTerm="+term+"&sm_sm="+sm;
			}else{
				hrefs = "/webApplicationFinancialInvest/financialBuy?onLineProductTerm="+term+"&sm_sm="+sm;
			}
		}
				
		document.getElementById(id).href=hrefs;
		document.getElementById(id).innerHTML=productName;
		document.getElementById(id).title=productName;
	}
});

function disBlock(id){
	document.getElementById(id).style.display='block';
}

function disNone(id){
	document.getElementById(id).style.display='none';
}
</script>

<script src="<%=request.getContextPath()%>/js/head.js" type="text/javascript"></script>
</head>

<body><div style="position: absolute; z-index: 19700; top: -1970px; left: -1970px; display: none;"><iframe style="width: 186px; height: 199px;" src="Forgot%20_files/My97DatePicker.htm" border="0" scrolling="no" frameborder="0"></iframe></div>
<input id="huodongbiaoId" name="huodongbiaoId" value="H2015080601" type="hidden">
	<div style="width:100%; margin:0;">

		<center>
			<jsp:include page="header.jsp"></jsp:include>
		</center>
	</div>

	<div class="head_pojoDiv_05"></div>
	<script type="text/javascript">
// 			function showTime(){
//                                 var show_day=new Array('星期一','星期二','星期三','星期四','星期五','星期六','星期日');
//                                 var week_day = new Array(7);
//                                 week_day[0] = '日';
//                                 week_day[1] = '一';
//                                 week_day[2] = '二';
//                                 week_day[3] = '三';
//                                 week_day[4] = '四';
//                                 week_day[5] = '五';
//                                 week_day[6] = '六';
//                                 var time=new Date();
//                                 var day=time.getDay();
//                                 var now_time = time.toLocaleString() +' '  + '星期' + week_day[day];
//                                 document.getElementById('showtime').innerHTML=now_time;
//                                 setTimeout("showTime();",1000);
//                             }
                            

			        /*判断浏览器版本是否过低*/
					function getIEversion(){
						var b_name = navigator.appName; 
						var b_version = navigator.appVersion; 
						var version = b_version.split(";");
						
						if (b_name == "Microsoft Internet Explorer") { 
							var trim_version = version[1].replace(/[ ]/g, ""); 					
							if (trim_version == "MSIE8.0" || trim_version == "MSIE7.0" || trim_version == "MSIE6.0") { 
								alert("此浏览器版本过低，请到指定网站去下载相关版本。"); 
								//然后跳到需要连接的下载网站
								//window.location.href="http://windows.microsoft.com/zh-CN/internet-explorer/download-ie"; 
							}
						}
					}
					
 

				//加入收藏
				function addFavorite2() {
				     var url = window.location;
				     var title = document.title;
				     var ua = navigator.userAgent.toLowerCase();
				     if (ua.indexOf("360se") > -1) {
				         alert("由于360浏览器功能限制，请按 Ctrl+D 手动收藏！");
				     }
				     else if (ua.indexOf("msie 8") > -1) {
				         window.external.AddToFavoritesBar(url, title); //IE8
				     }
				     else if (document.all) {
				   try{
				    window.external.addFavorite(url, title);
				   }catch(e){
				    alert("您的浏览器不支持,请按 Ctrl+D 手动收藏!");
				   }
				     }
				     else if (window.sidebar) {
				         window.sidebar.addPanel(title, url, "");
				     }
				     else {
				   alert("您的浏览器不支持,请按 Ctrl+D 手动收藏!");
				     }
				 }
				
				 
				//设为首页
				function SetHome(url){
					if (document.all) {
						document.body.style.behavior='url(#default#homepage)';
						document.body.setHomePage(url);
					}else{
						alert("您好,您的浏览器不支持自动设置页面为首页功能,请您手动在浏览器里设置该页面为首页!");
					}
				}
				//借款页面跳转
				function borproduct(){
					if($("#username").val()=="" || $("#username").val() == null){
						 window.location.href = "/webApplicationLoan/borProducts";
					}else if($("#username").val()!="" || $("#username").val() != null){
					 $.ajax({ 
						        url: "/webApplicationLoanApply/borvalproduct", 
						        dataType: 'json', 
						        error : function() {
						        $.ligerDialog.question("请求异常！请联系管理员...");
							      },
				                success:function(meg){
				                if(meg.statusCode== 300){
				                 window.location.href = "/webApplicationLoanApply/borMessage?productname="+meg.message+"&statu="+meg.navTabId;
				                }else{
				                 window.location.href = "/webApplicationLoan/borProducts";
				                }
                         }
                          });
					}
				}
				
								
	</script>


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7a4194d0e685be66c947452dc8646475";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>大钱(DAQIAN)--找回密码</title>





	<style>
.tab_register {
	margin: auto;
	width: 400px;
}

.tab_register input {
	margin-left: 10px;
}

.tab_tegister_td {
	color: #4D4D4D;
	font-size: 16px;
	font-family: '微软雅黑';
	text-align: right;
}

.tab_tegister_btk {
	width: 99px;
	height: 32px;
	text-align: center;
	color: #666666;
	border: 0;
	background: url(../styles/web/image/index/yanzheng.png);
	background-color:#d1d0d0;
}

.tab_tegister_btk1 {
	width: 280px;
	height: 40px;
	text-align: center;
	color: #fff;
	border: 0;
	background-color: #2ea7e0;
	font-size: 18px;
	font-family: '微软雅黑';
}

.tab_tegister_txt {
	width: 280px;
	height: 35px;
	border: 1px solid #CCCCCC;
	line-height: 35px;
	font-size: 16px;
	font-family: '微软雅黑';
	color: #666666;
}

.msg_hint_DIV {
	position: absolute;
	top: 0px;
	left: 0px;
	width: 100%;
	background-color: #FFF;
	filter: alpha(opacity =   70);
	-moz-opacity: 0.7;
	opacity: 0.8;
	display: none;
	z-index: 100;
}



.a {background-color: #F3F3F3; border-color: #FBFBFB; width:350px; border-width: 1px; border-style: solid; padding: 1px;}
.b {background-color: #D8D8D8; border-color: #E8E8E8; border-width: 1px; border-style: solid; padding: 1px;} 
.c {background-color: #FFF; border-color: #BBB; height: 160px;color:#ff0000; border-width: 1px; border-style: solid; padding: 1px;}
</style>
	<form action="/Daqian/user/login.jsp" method="post" id="form" style="background-color: #f3f4f8;">
	<table class="tab_register" border="0" cellpadding="0" cellspacing="0">
		<tbody><tr>
			<td class="tab_tegister_td" height="70">用户名:</td>
			<td><input id="username" name="username" class="tab_tegister_txt" maxlength="20" type="text"></td>
		</tr>
		<tr>
			<td class="tab_tegister_td" height="70">新密码:</td>
			<td><input id="password" name="password" class="tab_tegister_txt" maxlength="20" type="password"></td>
		</tr>
		<tr>
			<td class="tab_tegister_td" height="70">确认新密码:</td>
			<td><input id="passwords" name="passwords" class="tab_tegister_txt" maxlength="20" type="password"></td>
		</tr>
		<tr>
			<td class="tab_tegister_td" height="70">手机验证:</td>
			<td><input id="phone" name="phone" class="tab_tegister_txt" maxlength="20" type="text"></td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td><input name="send" id="send" onclick="sendMessage()" value="发送验证码" class="tab_tegister_btk" style="cursor:pointer;" type="button"></td>
		</tr>
		<tr>
			<td class="tab_tegister_td" height="70">验证码:</td>
			<td><input id="yz" name="yz" class="tab_tegister_txt" maxlength="6" type="text"></td>
		</tr>
		<tr>
			<td height="90">&nbsp;</td>
			<td><input name="" onclick="chkform();" value="重置密码" class="tab_tegister_btk1" style="cursor:pointer;" type="button"></td>
		</tr>
	</tbody></table>
	<input id="yzmsm" name="yzmsm" value="" type="hidden">
	</form>

<link href="<%=request.getContextPath()%>/Forgot%20_files/foot.css" rel="stylesheet" type="text/css">
<center>
	<jsp:include page="foot.jsp"></jsp:include>
</center>



<!--  
<div id="registerVerify_hint" class="msg_hint_DIV"></div>
	
	<div id="registerVerify_hint_DIV" style="display:none; width:350px; height:10px; background-color: #FFF; z-index: 110; position:absolute; ">	
		<div class="a">
			<div class="b"> 
				<div class="c">
        			<div style="width:190px; height:12px; background-color: #FFF;"></div>
        			<span style="font-size: 16px; font-family:Microsoft YaHei; color: red; font: bold;">&nbsp;&nbsp;验证</span>
					<div style="width:10px; height:10px; float:right;"></div>
    				<div id="close_registerVerify" title="关闭" style="width:18px; height:18px; background-image:url('../new_style/web_image/user_center/close_img_02.png'); background-repeat:no-repeat; float:right; cursor:pointer; "></div>
   					<div style="width:325px; clear:right; ">
   						<div style="width: 20px; height: 80px; float: left;"></div>
   		 				<div style="width: 300px; height: 80px; float: left;">
   		 				<div style="width: 300px; height: 15px;"></div>
   		 					<div style="width: 290px; height: 70px; margin-left: 10px;">
   		 						<div style="float: left; width: 170px; height: 40px;">
   		 							<span style="font-size: 15px; font-family:Microsoft YaHei; color: #555555;">验证码</span>
   		 							<input id="verificationCode" style="width: 100px; height: 30px; " type="text">
   		 						</div>
   		 						<div style="float: left; width: 120px; height: 40px;">
   		 							<img id="imgs02" src="Forgot%20_files/getImg.jpg" alt="验证码" title="点击刷新验证码" style="cursor: pointer;" onclick="change('imgs02')">
   		 						</div>
   		 						<div style="width: 50px; height: 20px;  clear: left; float: left;"></div>
   		 						<div id="erroe_code" style="width: 160px; height: 20px; float: left; font-family:Microsoft YaHei; text-align: left; font-size: 12px;"></div>
   		 					</div>			
   		 				</div>
           	 		</div>
           	 		<center>
	            		<div style="clear:left;  width: 90px; height: 22px; ">
		            		<div id="verification_code" style="float:left; width: 85px; height: 22px; background-color: #3598d8; border-radius:5px; -webkit-border-radius: 5px; cursor: pointer; color: #FFF; font-family:Microsoft YaHei; font-size: 15px;">验证</div>
	            		</div>
	            	</center>  	
    		   </div>
  			</div>  
		</div>	
	</div>
-->

<script type="text/javascript" language="javascript">
//获得ajax对象
function getXhr(){
	var xhr = null;
	if(window.XMLHttpRequest){
		xhr = new XMLHttpRequest();
	}else{
		 xhr = new ActiveXObject('microsoft.XMLHttp');
	}
	return xhr;
}

/*
//异步验证用户名是否存在
function checkname(){
		var value=$('#username').val();
		alert("a");
		var xhr = getXhr();
		//发送请求
		var uri = '/Daqian/checkpwdname.do?name='+value;
		xhr.open('get',uri,true);
		xhr.onreadystatechange=function(){
			//4,处理服务器返回的数据
			if(xhr.readyState==4&&xhr.status==200){
				var txt = xhr.responseText;
				alert(txt);
			}
		};
		xhr.send(null);
	}
	*/



		var valObj;
		var count = 60; //间隔函数，1秒执行  
		var curCount;//当前剩余秒数  
		var code = ""; //验证码  
		var codeLength = 6;//验证码长度  
		curCount = count		
		function sendMessage() {
			$form = $("#form");
			var phone = $("#phone", $form).val();
			var phoneSms = /^1[3|4|5|8][0-9]{9}$/;
			if (!phoneSms.test(phone)) {
				alert("请输入正确的手机号");
				return;
			}else {
				var value=$('#phone').val();
				var xhr = getXhr();
				//发送请求
				var uri = '/Daqian/sendsms.do?phone='+value;
				xhr.open('get',uri,true);
				xhr.onreadystatechange=function(){
					//4,处理服务器返回的数据
					if(xhr.readyState==4&&xhr.status==200){
						var txt = xhr.responseText;
					}
				};
				xhr.send(null);
													
//				for ( var i = 0; i < codeLength; i++) {
	//				code += parseInt(Math.random() * 9).toString();
//				}
//				document.getElementById("yzmsm").value = code;

//				$.ajax({
//					url : "/webApplicationSign/smsOther",
	//				data : $form.serialize(),
	//				dataType : 'json',
	//				success : function(msg) {
//
	//				},
	//				error : function() {
	//					alert("数据提交异常！请检查网络");
	//				}
	//			});

				// 设置button效果，开始计时  
				$("#send").attr("disabled", "true");
				$("#send").val(curCount + "秒内输验证码");
				valObj = window.setInterval(SetRemainTime, 1000); // 启动计时器，1秒执行一次

			}
		}

		//timer处理函数  
		function SetRemainTime() {

			if (curCount == 0) {
				window.clearInterval(valObj);// 停止计时器  
				$("#send").removeAttr("disabled");// 启用按钮  
				$("#send").val("重新发送验证码");
//				code = ""; // 清除验证码。如果不清除，过时间后，输入收到的验证码依然有效  
//				document.getElementById("yzmsm").value = code;
				curCount = 60;
			} else {
				curCount--;
				$("#send").val(curCount + "秒内输验证码");
			}
		}

		function chkform() {

			$form = $("#form");
			var username = $("#username", $form).val();
			var phone = $("#phone", $form).val();
			var yz = $("#yz", $form).val();
//			var yzmsm = $("#yzmsm", $form).val();
			var pwd1 = $("#password", $form).val();
			var pwd2 = $("#passwords", $form).val();
			var phoneSms = /^1[3|4|5|8][0-9]{9}$/;
			if (username == '' || phone == '' || yz == '' || pwd1 == ''
					|| pwd2 == '') {
				alert("有未填写项，请完善输入！");
			} else {
				if (pwd1 != pwd2) {
					alert("两次输入密码不一致！");
					return;
				} else if (pwd1.length < 7) {
					alert("您的密码设置不正确。设置要求：密码长度为7到20位且不能只含有数字，小写字母，大写字母、特殊字符。如：information15。");
					return;
				} else if (pwd1.length > 20) {
					alert("您的密码设置不正确。设置要求：密码长度为7到20位且不能只含有数字，小写字母，大写字母、特殊字符。如：information15。");
					return;
				} else if (/^[a-z]+$/.test(pwd1)
						|| /^[A-Z]+$/.test(pwd1)
						|| /^[0-9]+$/.test(pwd1)
						|| /^[`\!\@\#\$\%\^\&\*\(\)\-\+\=\/\.\,\?\>\<\|\\\[\]\{\}\s]+$/
								.test(pwd1)) {
					alert("您的密码设置不正确。设置要求：密码长度为7到20位且不能只含有数字，小写字母，大写字母、特殊字符。如：information15。");
					return;
				} else if (!phoneSms.test(phone)) {
					alert("请输入正确的手机号");
					return;
				}
				else {
						var xhr = getXhr();
						//发送请求
						var uri = '/Daqian/changepwd.do?name='+username+'&yz='+yz+'&pwd='+pwd1+'&phone='+phone;
						xhr.open('get',uri,true);
						xhr.onreadystatechange=function(){
							//4,处理服务器返回的数据
							if(xhr.readyState==4&&xhr.status==200){
								var txt = xhr.responseText;
								if(txt=="修改成功"){
									document.forms[0].submit();
								}
								alert(txt);
							}
						};
						xhr.send(null);	
				
				
/*						$.ajax({
								url : "/webApplicationSign/userPhone",
								type : 'POST',
								data : $form.serialize(),
								dataType : 'json',
								success : function(msg) {
									if (msg.statusCode == 300) {
										alert("用户名和您的预留手机号无法绑定,请重新输入！");
										return;
									} else {
											$.ajax({
													url : "/webApplicationSign/forPassModify",
													data : $form.serialize(),
													dataType : 'json',
													success : function(msg) {
														if (msg.statusCode == 300) {
															alert("重置密码失败");
														}
														if (msg.statusCode == 200) {
															alert("密码重置成功,请登录后进行申请");
															window.location.href = "/webApplicationIndex";
														}
													},
													error : function() {
														alert("数据提交异常！请检查网络");
													}
												});
									}
								},
								error : function() {
									alert("数据提交异常！请检查网络");
								}
							});
*/
				}
			}
		}
		
	
		
//获取窗口的高度
var windowHeight_registerVerify;

// 获取窗口的宽度
var windowWidth_registerVerify;

// 获取弹窗的宽度
var popWidth_registerVerify;

// 获取弹窗高度
var popHeight_registerVerify;

/*打开初始化页面*/
function init_registerVerify() {
	$("#registerVerify_hint").css("height",document.body.scrollHeight+"px");
	$("#registerVerify_hint").css("display","block");
	
	windowHeight_registerVerify = $(window).height();
	windowWidth_registerVerify = $(window).width();
	
	popHeight_registerVerify = $("#registerVerify_hint_DIV").height();
	popWidth_registerVerify = $("#registerVerify_hint_DIV").width();

}

// 关闭窗口的方法
function closeWindow_registerVerify() {

	$("#close_registerVerify").click(function() {
		$("body").eq(0).css("overflow","");
		$("#registerVerify_hint").css("display", "none");
		$("#registerVerify_hint_DIV").css("display", "none");	
	
	});
	
}

// 定义弹出居中窗口的方法
function popCenterWindow_registerVerify() {
	$("body").eq(0).css("overflow","hidden");	
	change('imgs02');//刷新验证码
	
	init_registerVerify();

	// 计算弹出窗口的左上角Y的偏移量
	var popY_registerVerify = (windowHeight_registerVerify - popHeight_registerVerify) / 2 - 80;
	var popX_registerVerify = (windowWidth_registerVerify - popWidth_registerVerify) / 2;
	
	// 设定窗口的位置
	$("#registerVerify_hint_DIV").css("top", popY_registerVerify).css("left", popX_registerVerify).show();
	
	closeWindow_registerVerify();

}

/*刷新验证码*/
function change(imgObj){
	document.getElementById(imgObj).src="/webApplicationSign/getImg?date=" + new Date().getTime();
	
}
	

$(document).ready(function(){
	//ajax判断验证码是否正确
	$("#verification_code").click(function(){
		if($("#verificationCode").val() == ""){
			$("#erroe_code").html("× 验证码不允许为空");
			return;
		}
		
		$.ajax({
			url : "/webApplicationSign/validationImg?inputRandomCode="+$("#verificationCode").val(),
			type : 'post',
			dataType : 'json',
			success:function(msg){
				if(msg.statusCode == 300){
					$("#erroe_code").html("× 验证码错误");
					return;
				}else if(msg.statusCode == 200){
					//发送验证码
					
					//关闭窗口
					$("body").eq(0).css("overflow","");	
					$("#registerVerify_hint").css("display", "none");
					$("#registerVerify_hint_DIV").css("display", "none");
					
					 for ( var i = 0; i < codeLength; i++) {
						code += parseInt(Math.random() * 9).toString();
					}
					document.getElementById("yzmsm").value = code;

					$.ajax({
						url : "/webApplicationSign/smsOther",
						data : $form.serialize(),
						dataType : 'json',
						success : function(msg) {
	
						},
						error : function() {
							alert("数据提交异常！请检查网络");
						}
					});
	
					// 设置button效果，开始计时  
					$("#send").attr("disabled", "true");
					$("#send").val(curCount + "秒内输验证码");
					valObj = window.setInterval(SetRemainTime, 1000); // 启动计时器，1秒执行一次 
						
				}						
			}
		});	
	});	
});	
	
	
</script>
</body>
</html>
